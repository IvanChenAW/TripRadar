<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>TripRadar Â· å»ºè­°æ—…éŠåˆ†æ•¸ï¼ˆå¤šèª / 13 é¢¨æ™¯å€ / å¯ç”¨åŠŸèƒ½ï¼‰v5.9.2</title>
<style>
:root{
  --brand:#1d4ed8; --ink:#0f172a; --muted:#64748b; --panel:#f8fafc;
  --ok:#16a34a; --okbg:#ecfdf5; --blue:#2563eb; --amber:#f59e0b; --red:#ef4444;
}
html,body{margin:0;background:#eef2f7;color:var(--ink);font:16px/1.5 system-ui,-apple-system,"Noto Sans TC","Segoe UI","Noto Sans JP",Roboto,sans-serif}
.header{background:linear-gradient(180deg,#1d4ed8,#60a5fa);color:#fff;padding:16px 14px 26px;position:sticky;top:0;z-index:9}
.wrap{max-width:1200px;margin:auto;padding:14px}
.title{font-weight:900;font-size:22px}
.sub{opacity:.95;margin-top:6px}
.legend{display:flex;gap:14px;flex-wrap:wrap;margin-top:10px}
.bullet{display:inline-flex;align-items:center;gap:6px}
.dot{width:10px;height:10px;border-radius:50%}
.dok{background:#22c55e}.dblue{background:#3b82f6}.damber{background:#f59e0b}.dred{background:#ef4444}
.lang{position:absolute;right:10px;top:10px;display:flex;gap:6px}
.lang button{border:none;border-radius:8px;color:#1e3a8a;background:#fff;padding:2px 8px;font-weight:800;cursor:pointer}
.lang button.active{background:#0ea5e9;color:#fff}
.board{display:grid;grid-template-columns:repeat(12,1fr);gap:16px;margin-top:-22px}
.col{grid-column:span 12}
@media (min-width:720px){.col{grid-column:span 6}}
@media (min-width:1040px){.col{grid-column:span 4}}
.card{background:#fff;border:1px solid #e5e7eb;border-radius:14px;padding:12px;box-shadow:0 8px 15px rgba(2,6,23,.04)}
.head{display:flex;justify-content:space-between;align-items:center}
.loc{font-size:18px;font-weight:900}
.region{color:var(--muted);font-weight:700}
.score{border-radius:999px;color:#fff;font-weight:900;padding:10px 14px}
.sc-green{background:#22c55e}.sc-blue{background:#3b82f6}.sc-amber{background:#f59e0b}.sc-red{background:#ef4444}
.tags{display:flex;gap:8px;flex-wrap:wrap;margin:10px 0}
.tag{background:#f1f5f9;border-radius:999px;padding:8px 10px;font-weight:800;color:#1e293b}
.rec{font-weight:900;margin-bottom:6px}
.actions{display:flex;gap:8px;flex-wrap:wrap}
.btn{border:none;border-radius:12px;background:#e2e8f0;padding:10px 12px;font-weight:800;cursor:pointer}
.btn.link{background:#eef2ff;color:#2563eb}
.badge{display:inline-flex;align-items:center;gap:6px;border-radius:10px;background:#ecfeff;color:#155e75;padding:6px 10px;font-weight:800}
.time{color:#0f172a;background:#fff;border:1px dashed #cbd5e1;border-radius:10px;padding:6px 10px;display:inline-flex;gap:8px;align-items:center}
.footer{color:#475569;font-weight:700;margin-top:8px}
.modal-mask{position:fixed;inset:0;background:rgba(15,23,42,.45);display:none;align-items:center;justify-content:center;z-index:50}
.modal{background:#fff;border-radius:16px;width:min(720px,92vw);padding:16px;border:1px solid #e5e7eb}
.modal h3{margin:0 0 6px 0}
.msec{margin-top:8px;border-left:4px solid #e2e8f0;padding-left:8px}
.mok{background:var(--okbg);border-radius:10px;padding:10px}
.warn{background:#fff7ed;border-radius:10px;padding:10px}
.dng{background:#fef2f2;border-radius:10px;padding:10px}
</style>
</head>
<body>
  <div class="header">
    <div class="lang">
      <button class="lbtn active" data-lang="zh">ä¸­</button>
      <button class="lbtn" data-lang="en">EN</button>
      <button class="lbtn" data-lang="jp">æ—¥</button>
    </div>
    <div class="title" id="t-app">TripRadar</div>
    <div class="sub">
      <span id="t-sub">è¡Œå‰ 1 åˆ†é˜ Â· å»ºè­°æ—…éŠåˆ†æ•¸ + ä¸€å¥å»ºè­°</span>
      <span class="time" id="t-time" style="margin-left:8px"></span>
    </div>
    <div class="legend">
      <div class="bullet"><span class="dot dok"></span><span id="lg1">â‰¥90 éå¸¸é©åˆå‡ºéŠ</span></div>
      <div class="bullet"><span class="dot dblue"></span><span id="lg2">75â€“89 é©åˆå‡ºéŠ</span></div>
      <div class="bullet"><span class="dot damber"></span><span id="lg3">60â€“74 å°šå¯å‡ºéŠ</span></div>
      <div class="bullet"><span class="dot dred"></span><span id="lg4"><60 å»ºè­°æ”¹æœŸ</span></div>
    </div>
  </div>

  <div class="wrap">
    <div class="board" id="board"></div>
    <div class="footer" id="legal">Â© 2025 TripRadarï¼ˆDEMOï¼‰ Â· æœ¬é ç‚ºå±•ç¤ºç”¨ï¼Œè‹¥ç¶²è·¯ä¸ç©©å®šç³»çµ±æœƒä»¥å¿«å–/ç¤ºæ„å‘ˆç¾ã€‚</div>
  </div>

  <!-- Modal -->
  <div class="modal-mask" id="mask">
    <div class="modal">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <h3 id="mTitle">ç•¶åœ°ç‹€æ³</h3>
        <button class="btn" id="mClose">âœ•</button>
      </div>
      <div class="msec">
        <div class="mok" id="mTraffic">äº¤é€šç‹€æ³ï¼šé †æš¢</div>
      </div>
      <div class="msec" style="margin-top:10px">
        <div class="warn" id="mDisaster">ç½å®³é¢¨éšªï¼šä½</div>
      </div>
    </div>
  </div>

<script>
/* ============ èªè¨€åŒ… ============ */
const I18N={
  zh:{ app:"TripRadar", sub:"è¡Œå‰ 1 åˆ†é˜ Â· å»ºè­°æ—…éŠåˆ†æ•¸ + ä¸€å¥å»ºè­°",
    time:"æ›´æ–°æ™‚é–“", ok:"éå¸¸é©åˆå‡ºéŠ", good:"é©åˆå‡ºéŠ", fair:"å°šå¯å‡ºéŠ", bad:"å»ºè­°æ”¹æœŸ",
    temp:"æ°£æº«", rain:"é™é›¨", uv:"ç´«å¤–ç·š", aqi:"ç©ºæ°£å“è³ª",
    score:"å»ºè­°æ—…éŠåˆ†æ•¸", map:"åœ°åœ–å°èˆª", pin:"ä¸€éµåˆ°é»", site:"å®˜æ–¹ç¶²ç«™", status:"ç•¶åœ°ç‹€æ³",
    modalTitle:"ç•¶åœ°ç‹€æ³", traffic:"äº¤é€šç‹€æ³", disaster:"ç½å®³é¢¨éšª",
    tSmooth:"é †æš¢", tBusy:"å£…å¡", tClosed:"ç®¡åˆ¶/å°é–‰",
    dLow:"ä½", dWatch:"æ³¨æ„", dWarn:"è­¦æˆ’",
    tip:["å±±å€å¥½å¤©æ°£ï¼Œå»ºè­°æ—©å‡ºç™¼é¿é–‹è»Šæ½®ã€‚","åˆå¾Œå¯èƒ½è½‰é™£é›¨ï¼Œè¨˜å¾—å‚™é›¨å…·ã€‚","ç´«å¤–ç·šè¼ƒå¼·ï¼ŒåŠ å¸½å­èˆ‡é˜²æ›¬ã€‚","ç©ºå“æ™®é€šï¼Œæ•æ„Ÿæ—ç¾¤ç•™æ„ã€‚"]
  },
  en:{ app:"TripRadar", sub:"1-min Before Trip Â· Score & One-line Advice",
    time:"Updated", ok:"Perfect", good:"Good", fair:"Fair", bad:"Postpone",
    temp:"Temp", rain:"Rain", uv:"UV", aqi:"Air Quality",
    score:"Trip Score", map:"Directions", pin:"Pin", site:"Official Site", status:"Local Status",
    modalTitle:"Local Status", traffic:"Traffic", disaster:"Disaster Risk",
    tSmooth:"Smooth", tBusy:"Congested", tClosed:"Restricted/Closed",
    dLow:"Low", dWatch:"Watch", dWarn:"Warning",
    tip:["Great weather in mountains. Start early.","Showers likely in afternoon; bring rainwear.","High UVâ€”use sunscreen/hat.","Air quality moderateâ€”be cautious."]
  },
  jp:{ app:"TripRadar", sub:"å‡ºç™ºå‰1åˆ† Â· æ—…è¡Œã‚¹ã‚³ã‚¢ï¼‹ã²ã¨ã“ã¨",
    time:"æ›´æ–°", ok:"æœ€é©", good:"è‰¯ã„", fair:"ã¾ãšã¾ãš", bad:"å»¶æœŸæ¨å¥¨",
    temp:"æ°—æ¸©", rain:"é™æ°´", uv:"UV", aqi:"ç©ºæ°—å“è³ª",
    score:"æ—…è¡Œã‚¹ã‚³ã‚¢", map:"åœ°å›³æ¡ˆå†…", pin:"ç›®çš„åœ°ã¸", site:"å…¬å¼ã‚µã‚¤ãƒˆ", status:"ç¾åœ°æƒ…å ±",
    modalTitle:"ç¾åœ°æƒ…å ±", traffic:"äº¤é€šçŠ¶æ³", disaster:"ç½å®³ãƒªã‚¹ã‚¯",
    tSmooth:"ã‚¹ãƒ ãƒ¼ã‚º", tBusy:"æ¸‹æ»", tClosed:"é€šè¡Œè¦åˆ¶",
    dLow:"ä½ã„", dWatch:"æ³¨æ„", dWarn:"è­¦æˆ’",
    tip:["å±±é–“ã¯å¥½å¤©ã€‚æ—©ã‚ã®å‡ºç™ºã‚’ã€‚","åˆå¾Œã¯ã«ã‚ã‹é›¨ã®å¯èƒ½æ€§ã€é›¨å…·ã‚’ã€‚","UVå¼·ã‚ã€‚å¸½å­ã¨æ—¥ç„¼ã‘æ­¢ã‚ã‚’ã€‚","ç©ºæ°—ã¯æ™®é€šã€‚æ•æ„Ÿãªæ–¹ã¯ã”æ³¨æ„ã€‚"]
  }
};
let LANG="zh";

/* ============ 13 é¢¨æ™¯å€è³‡æ–™ï¼ˆåº§æ¨™ï¼‹å®˜ç¶²ï¼‰ ============ */
const SPOTS=[
  {name:"æ±åŒ—è§’æš¨å®œè˜­æµ·å²¸", region:"æ–°åŒ—/å®œè˜­", lat:25.116, lng:121.910, site:"https://www.necoast-nsa.gov.tw/"},
  {name:"åŒ—æµ·å²¸åŠè§€éŸ³å±±", region:"æ–°åŒ—",       lat:25.236, lng:121.453, site:"https://www.northguan-nsa.gov.tw/"},
  {name:"æ—¥æœˆæ½­",           region:"å—æŠ•ç¸£",   lat:23.865, lng:120.916, site:"https://www.sunmoonlake.gov.tw/"},
  {name:"é˜¿é‡Œå±±",           region:"å˜‰ç¾©ç¸£",   lat:23.508, lng:120.801, site:"https://www.ali-nsa.net/"},
  {name:"èŠ±æ±ç¸±è°·",         region:"èŠ±è“®/å°æ±", lat:23.300, lng:121.300, site:"https://www.erv-nsa.gov.tw/"},
  {name:"æ±éƒ¨æµ·å²¸",         region:"èŠ±è“®/å°æ±", lat:23.150, lng:121.410, site:"https://www.eastcoast-nsa.gov.tw/"},
  {name:"è¥¿æ‹‰é›…",           region:"å°å—/å˜‰ç¾©", lat:23.256, lng:120.450, site:"https://www.siraya-nsa.gov.tw/"},
  {name:"é›²å˜‰å—æ¿±æµ·",       region:"é›²æ—/å˜‰ç¾©/å°å—", lat:23.173, lng:120.061, site:"https://www.swcoast-nsa.gov.tw/"},
  {name:"æ¾æ¹–",             region:"æ¾æ¹–ç¸£",   lat:23.571, lng:119.579, site:"https://www.penghu-nsa.gov.tw/"},
  {name:"é¦¬ç¥–",             region:"é€£æ±Ÿç¸£",   lat:26.160, lng:119.952, site:"https://www.matsu-nsa.gov.tw/"},
  {name:"é‡‘é–€",             region:"é‡‘é–€ç¸£",   lat:24.444, lng:118.318, site:"https://www.kinmen-nsa.gov.tw/"},
  {name:"èŒ‚æ—",             region:"é«˜é›„/å±æ±", lat:22.885, lng:120.684, site:"https://www.maolin-nsa.gov.tw/"},
  {name:"å¤ªé­¯é–£",           region:"èŠ±è“®ç¸£",   lat:24.165, lng:121.618, site:"https://www.taroko.gov.tw/"} /* åœ‹å®¶å…¬åœ’ï¼Œä½†ä¿ç•™ä½ çš„æ¸…å–® */
];

/* ============ ç©©å®šéš¨æ©Ÿï¼ˆä¾åç¨±åš seedï¼‰ï¼Œè®“æ¯å€ä¸åŒ ============ */
function xmur3(str){let h=1779033703^str.length;for(let i=0;i<str.length;i++){h=Math.imul(h^str.charCodeAt(i),3432918353);h=h<<13|h>>>19;}return()=>{h=Math.imul(h^h>>>16,2246822507);h=Math.imul(h^h>>>13,3266489909);return(h^h>>>16)>>>0}}
function rand(seed){const s=xmur3(seed)();return()=>((s/4294967295)+(Math.sin(s)*1e4%1+1)%1)%1}

/* ============ è‰²éšèˆ‡å»ºè­° ============ */
function color(score){ if(score>=90)return"sc-green"; if(score>=75)return"sc-blue"; if(score>=60)return"sc-amber"; return"sc-red"; }
function recText(score){ const t=I18N[LANG]; if(score>=90)return t.ok; if(score>=75)return t.good; if(score>=60)return t.fair; return t.bad; }

/* ============ ç”¢ç”Ÿæ¯å€çš„æ¨¡æ“¬è³‡æ–™ï¼ˆç©©å®šä¸åŒï¼‰ ============ */
function makeData(spot){
  const r=rand(spot.name);
  const temp=(18+ r()*12);                 // 18~30
  const rain=(5  + r()*70)|0;              // 5~75%
  const uv=(3 + r()*8)|0;                  // 3~11
  const aqi=(20 + r()*80)|0;               // 20~100
  // åˆ†æ•¸ï¼šT(0.25) + (100-POP)*0.35 + AQI è½‰æ‰£åˆ† + UVå°æ‰£ + éš¨æ©Ÿå¾®å‹•
  let base = 50 + (30 - Math.abs(temp-24))*0.25;    // 18~30 ä»¥ 24 ç‚ºä½³
  base += (100-rain)*0.35/1.0;
  base += (80 - Math.max(0,aqi-20))*0.25/1.0;       // AQI 20~100ï¼Œè¶Šé«˜è¶Šæ‰£
  base -= Math.max(0,uv-7)*1.5;                      // é«˜ UV å°æ‰£
  base += (r()*6-3);                                 // Â±3 æµ®å‹•
  const score=Math.max(20,Math.min(99,Math.round(base)));

  // äº¤é€š/ç½å®³ï¼šæ ¹æ“šé›¨é‡èˆ‡éš¨æ©Ÿ
  let tState="smooth", dState="low";
  if(rain>60) dState="warn";
  else if(rain>35) dState="watch";
  if(rain>55) tState="busy";
  if(r()>0.92 && rain>50) tState="closed"; // å°æ©Ÿç‡å°é–‰

  return {temp:temp.toFixed(1), rain, uv, aqi, score, tState, dState};
}

/* ============ é–‹åœ–ï¼å°èˆªï¼ˆiOS/Android é€šç”¨ï¼‰ ============ */
function openMap(lat,lng,name){
  const ua=navigator.userAgent.toLowerCase();
  const q=encodeURIComponent(name);
  if(/iphone|ipad|macintosh/.test(ua)) location.href=`http://maps.apple.com/?ll=${lat},${lng}&q=${q}`;
  else location.href=`https://maps.google.com/?q=${q}&ll=${lat},${lng}`;
}
function openNav(lat,lng,name){
  const ua=navigator.userAgent.toLowerCase();
  const q=encodeURIComponent(name);
  if(/iphone|ipad|macintosh/.test(ua)) location.href=`http://maps.apple.com/?daddr=${lat},${lng}&dirflg=d&t=r`;
  else location.href=`https://www.google.com/maps/dir/?api=1&destination=${lat},${lng}&travelmode=driving`;
}

/* ============ å½ˆçª— ============ */
const $=q=>document.querySelector(q);
function showModal(title,traffic,disaster){
  $("#mTitle").innerText=title;
  $("#mTraffic").innerText=traffic;
  $("#mDisaster").innerText=disaster;
  $("#mask").style.display="flex";
}
$("#mClose").onclick=()=>$("#mask").style.display="none";

/* ============ æ¸²æŸ“ ============ */
function render(){
  const t=I18N[LANG];
  $("#t-app").innerText=t.app;
  $("#t-sub").innerText=t.sub;
  $("#t-time").innerHTML=`ğŸ•’ ${t.time}ï¼š${new Date().toLocaleString()}`;
  $("#lg1").innerText=`â‰¥90 ${t.ok}`; $("#lg2").innerText=`75â€“89 ${t.good}`;
  $("#lg3").innerText=`60â€“74 ${t.fair}`; $("#lg4").innerText=`<60 ${t.bad}`;

  const html=SPOTS.map(sp=>{
    const d=makeData(sp);
    const cls=color(d.score);
    const rec=recText(d.score);
    return `
      <div class="col">
        <div class="card">
          <div class="head">
            <div>
              <div class="loc">${sp.name}</div>
              <div class="region">${sp.region}</div>
            </div>
            <div class="score ${cls}">${t.score} ${d.score}</div>
          </div>
          <div class="tags">
            <div class="tag">ğŸŒ¡ï¸ ${t.temp} ${d.temp}Â°C</div>
            <div class="tag">ğŸŒ§ï¸ ${t.rain} ${d.rain}%</div>
            <div class="tag">â˜€ï¸ ${t.uv} ${d.uv}</div>
            <div class="tag">ğŸ«§ ${t.aqi} ${d.aqi}</div>
          </div>
          <div class="rec">ğŸ‘‰ ${rec} Â· ${t.tip[(Math.abs(sp.name.length)%t.tip.length)]}</div>
          <div class="actions">
            <button class="btn" onclick="openNav(${sp.lat},${sp.lng},'${sp.name}')">ğŸ“ ${t.pin}</button>
            <button class="btn" onclick="openMap(${sp.lat},${sp.lng},'${sp.name}')">ğŸ—ºï¸ ${t.map}</button>
            <button class="btn link" onclick="window.open('${sp.site}','_blank')">ğŸ§¾ ${t.site}</button>
            <button class="btn" onclick="localStatus('${sp.name}','${sp.region}',${sp.lat},${sp.lng})">ğŸš¦ ${t.status}</button>
          </div>
        </div>
      </div>`;
  }).join("");
  $("#board").innerHTML=html;
}

/* ä¾ç›®å‰èªè¨€ç”¢ç”Ÿå½ˆçª—æ–‡å­— */
function localStatus(name,region,lat,lng){
  const t=I18N[LANG];
  const d=makeData({name});  // åŒ seed å¾—åˆ°ç©©å®šå€¼
  const mapTraffic={
    smooth:t.tSmooth,
    busy:t.tBusy,
    closed:t.tClosed
  };
  const mapDisaster={
    low:t.dLow,
    watch:t.dWatch,
    warn:t.dWarn
  };
  const traffic=`${t.traffic}ï¼š${mapTraffic[d.tState]}${d.tState==='busy'?'ï¼ˆ'+(LANG==='zh'?'å¯èƒ½éœ€åˆ†æµ':'possible diversion')+'ï¼‰':''}`;
  let dNote="";
  if(d.dState==="warn"){
    dNote = LANG==='zh' ? "ï¼ˆå±±å€æ˜“è½çŸ³ï¼åœŸçŸ³æµï¼Œéƒ¨åˆ†æ­¥é“å¯èƒ½å°é–‰ï¼‰"
         : LANG==='en' ? " (Rockfall/landslide risk; some trails may be closed)"
         : "ï¼ˆè½çŸ³ãƒ»åœŸç ‚ç½å®³ã®æã‚Œã€æ­©é“ä¸€éƒ¨é–‰é–ã®å¯èƒ½æ€§ï¼‰";
  }else if(d.dState==="watch"){
    dNote = LANG==='zh' ? "ï¼ˆç•™æ„çŸ­å»¶æ™‚å¼·é™é›¨ï¼‰"
         : LANG==='en' ? " (Short intense showers possible)"
         : "ï¼ˆçŸ­æ™‚é–“å¼·é›¨ã«æ³¨æ„ï¼‰";
  }
  const disaster=`${t.disaster}ï¼š${mapDisaster[d.dState]} ${dNote}`;
  showModal(`${t.modalTitle} Â· ${name}ï¼ˆ${region}ï¼‰`,traffic,disaster);
}

/* èªè¨€åˆ‡æ› */
document.querySelectorAll(".lbtn").forEach(btn=>{
  btn.onclick=()=>{
    document.querySelectorAll(".lbtn").forEach(b=>b.classList.remove("active"));
    btn.classList.add("active");
    LANG=btn.dataset.lang;
    render();
  };
});

render();
</script>
</body>
</html>
